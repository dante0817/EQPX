unit UTILS_fileIO;

interface

procedure OpenAtlasDataFolder;

implementation

uses
  System.SysUtils, Vcl.Dialogs, Winapi.ShellAPI, Winapi.Windows, EQPX_1;

procedure OpenAtlasDataFolder;
var
  FirstRowDate: string;
  Year, Month, Day: string;
  FolderPath: string;
begin
  with frmMain do
  begin
      // Access the first row date (assuming date is in the first column)
      FirstRowDate := sgEQ_events.Cells[0, 1];  // e.g., '2020-01-02'

      // Extract the year, month, and day from the date
      Year := Copy(FirstRowDate, 1, 4);   // '2020'
      Month := Copy(FirstRowDate, 6, 2);  // '01'
      Day := Copy(FirstRowDate, 9, 2);    // '02'

      // Construct the folder path using the base path from lblProgramPath
      FolderPath := IncludeTrailingPathDelimiter(lblProgramPath.Caption) +
                    'DB\ATLASDATA\' + Year + '\' + Month + '\' + Year + Month + Day;

      // Check if the folder exists
      if DirectoryExists(FolderPath) then
      begin
        // Open the folder in Windows Explorer
        ShellExecute(0, 'open', PChar(FolderPath), nil, nil, SW_SHOWNORMAL);
      end
      else
      begin
        ShowMessage('Folder does not exist: ' + FolderPath);
      end;
  end;
end;

end.
